# sudhishbommaraju.github.io
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Safepath</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        header {
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
        }
        .container {
            display: flex;
            height: calc(100vh - 80px);
        }
        .sidebar {
            width: 300px;
            background-color: white;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            overflow-y: auto;
        }
        input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            width: 100%;
            padding: 10px;
            background-color: #3498db;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 4px;
        }
        button:hover {
            background-color: #2980b9;
        }
        .map {
            flex: 1;
            height: 100%;
        }
        .route-option {
            padding: 10px;
            margin: 5px 0;
            background-color: #ecf0f1;
            cursor: pointer;
            border-radius: 4px;
        }
        .route-option.selected {
            background-color: #3498db;
            color: white;
        }
    </style>
</head>

<body>
    <header>
        <h1>Safepath</h1>
        <p>Find the safest and quickest paths using latest crime data</p>
    </header>

    <div class="container">
        <div class="sidebar">
            <input id="start" placeholder="Start location (e.g., New York, NY)">
            <input id="end" placeholder="End location (e.g., Los Angeles, CA)">
            <button onclick="findPaths()">Find Paths</button>
            <div id="routes"></div>
            <div id="crime-stats" style="margin-top:20px;"></div>
        </div>

        <div id="map" class="map"></div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>

    <script>
        let map;
        let routeLayers = [];
        let crimeMarkers = [];

        const ORS_API_KEY = "YOUR_ORS_KEY_HERE";

        const mockCrimes = [
            { lat: 40.7128, lng: -74.0060, type: "Theft", desc: "Theft in NYC" },
            { lat: 34.0522, lng: -118.2437, type: "Robbery", desc: "Robbery in LA" },
            { lat: 41.8781, lng: -87.6298, type: "Assault", desc: "Assault in Chicago" },
            { lat: 37.7749, lng: -122.4194, type: "Theft", desc: "Theft in SF" }
        ];

        function initMap() {
            map = L.map("map").setView([37.0902, -95.7129], 4);
            L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png")
                .addTo(map);
        }

        async function geocode(query) {
            const url = `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(query)}&format=json&limit=1`;
            const res = await fetch(url);
            const data = await res.json();
            if (data.length === 0) throw new Error("Location not found");

            return {
                lat: parseFloat(data[0].lat),
                lng: parseFloat(data[0].lon)
            };
        }

        async function getRoutesORS(start, end) {
            const body = {
                coordinates: [
                    [start.lng, start.lat],
                    [end.lng, end.lat]
                ],
                instructions: false
            };

            const res = await fetch("https://api.openrouteservice.org/v2/directions/driving-car", {
                method: "POST",
                headers: {
                    "Authorization": ORS_API_KEY,
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(body)
            });

            const data = await res.json();

            return [data.features[0]];
        }

        function addCrimeMarkers() {
            crimeMarkers.forEach(m => map.removeLayer(m));
            crimeMarkers = [];

            mockCrimes.forEach(c => {
                const marker = L.marker([c.lat, c.lng]).addTo(map)
                    .bindPopup(`<b>${c.type}</b><br>${c.desc}`);
                crimeMarkers.push(marker);
            });
        }

        function calculateSafetyScore(routeGeoJSON) {
            const line = turf.lineString(routeGeoJSON.geometry.coordinates);
            let score = 0;

            mockCrimes.forEach(c => {
                const point = turf.point([c.lng, c.lat]);
                const dist = turf.distance(point, line, { units: "kilometers" });

                if (dist < 1) score++;
            });

            return score;
        }

        function drawRoutes(routes) {
            routeLayers.forEach(r => map.removeLayer(r));
            routeLayers = [];

            routes.forEach((route, index) => {
                const layer = L.geoJSON(route, {
                    style: { color: "#3498db", weight: 5 }
                }).addTo(map);

                routeLayers.push(layer);
            });

            const group = L.featureGroup(routeLayers);
            map.fitBounds(group.getBounds());
        }

        async function findPaths() {
            const s = document.getElementById("start").value;
            const e = document.getElementById("end").value;

            if (!s || !e) {
                alert("Enter both start and end");
                return;
            }

            try {
                const start = await geocode(s);
                const end = await geocode(e);

                addCrimeMarkers();

                const routes = await getRoutesORS(start, end);

                const routeOptions = routes.map((r, i) => ({
                    index: i,
                    distance: r.properties.summary.distance / 1000,
                    time: r.properties.summary.duration / 60,
                    safety: calculateSafetyScore(r)
                }));

                drawRoutes(routes);
                renderRouteOptions(routeOptions);

                document.getElementById("crime-stats").innerHTML = `
                    <strong>Crime Stats Loaded:</strong><br>
                    ${mockCrimes.length} incidents near this route.
                `;

            } catch (err) {
                alert("Error: " + err.message);
            }
        }

        function renderRouteOptions(options) {
            const div = document.getElementById("routes");
            let html = "";

            options.forEach(o => {
                html += `
                    <div class="route-option" onclick="selectRoute(${o.index})">
                        <strong>Route ${o.index + 1}</strong><br>
                        Distance: ${o.distance.toFixed(1)} km<br>
                        Time: ${o.time.toFixed(1)} min<br>
                        Crimes Nearby: ${o.safety}
                    </div>
                `;
            });

            div.innerHTML = html;
        }

        function selectRoute(index) {
            routeLayers.forEach((layer, i) => {
                layer.setStyle({
                    color: i === index ? "#e74c3c" : "#3498db",
                    weight: i === index ? 7 : 5
                });
            });

            document.querySelectorAll(".route-option").forEach((opt, i) => {
                opt.classList.toggle("selected", i === index);
            });
        }

        initMap();
    </script>
</body>
</html>

